---
import { type CollectionEntry, getCollection } from "astro:content";
import { STORE } from "@consts";
import { getLangFromUrl, useTranslations } from "@i18n/utils";
import Layout from "@layouts/Layout.astro";
import Item from "@components/Store/Item.astro";
import { languages } from "@i18n/ui";

export async function getStaticPaths() {
    const store = (await getCollection("store")).sort(
        (a, b) => b.data.releaseDate.valueOf() - a.data.releaseDate.valueOf(),
    );

    const paths = store.flatMap((item) =>
        languages.map((lang) => ({
            params: { lang, slug: item.id || undefined },
            props: item,
        })),
    );

    return paths;
}

const items = await getCollection("store");

const lang = getLangFromUrl(Astro.url);
const t = useTranslations(lang);
---

<Layout
    title={STORE.TITLE}
    siteName="Futureblur Store"
    description={t("store.description")}
    cover={STORE.COVER}
>
    <div class="page-spacing max-w-screen-3xl mx-auto px-6">
        <div class="space-y-10">
            <section class="animate space-y-10">
                <h1>Starter Kits</h1>
                <div class="-mx-10 flex flex-wrap">
                    {items.map((item) => <Item item={item} />)}
                </div>
            </section>
        </div>
    </div>
</Layout>
