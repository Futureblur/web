---
import Layout from "@layouts/Layout.astro";
import { WORK } from "@consts";
import { getLangFromUrl, useTranslations } from "@i18n/utils";
import { Image } from "astro:assets";

export async function getStaticPaths() {
  return [
    { params: { lang: 'en' } },
    { params: { lang: 'de' }}
  ];
}

const t = useTranslations(getLangFromUrl(Astro.url));

// Import all images from the work folder as static assets using Astro's recommended style
const images = import.meta.glob<{ default: ImageMetadata }>(
  "/public/images/work/*.{jpg,jpeg,png,tiff,webp,gif}",
  { eager: true }
);

---

<Layout
    title={t("work.title")}
    siteName="Work"
    description={t("work.description")}
    cover={WORK.COVER}
>
    <div class="page-spacing mx-auto px-4 select-none">
        <div class="flex flex-col sm:flex-row gap-2 sm:gap-4">
            {(() => {
                const imageEntries = Object.entries(images).sort(([a], [b]) => a.localeCompare(b));
                const col1 = imageEntries.filter((_, idx) => idx % 2 === 0);
                const col2 = imageEntries.filter((_, idx) => idx % 2 === 1);
                return (
                    <>
                        <div class="flex-1 flex flex-col gap-2 sm:gap-4">
                            {col1.map(([path, image]) => {
                                const fileName = path.split('/').pop() ?? '';
                                return (
                                    <Image
                                        src={image.default}
                                        alt={fileName}
                                        class="w-full h-[60vw] sm:h-auto object-cover rounded-lg select-none"
                                        loading="lazy"
                                        draggable={false}
                                    />
                                );
                            })}
                        </div>
                        <div class="flex-1 flex flex-col gap-2 sm:gap-4 mt-0">
                            {col2.map(([path, image]) => {
                                const fileName = path.split('/').pop() ?? '';
                                return (
                                    <Image
                                        src={image.default}
                                        alt={fileName}
                                        class="w-full h-[60vw] sm:h-auto object-cover rounded-lg select-none"
                                        loading="lazy"
                                        draggable={false}
                                    />
                                );
                            })}
                        </div>
                    </>
                );
            })()}
        </div>
    </div>
</Layout>
